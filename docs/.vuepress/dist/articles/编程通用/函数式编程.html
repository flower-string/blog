<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>函数式编程 | CHAO BLOG</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="this is a blog build by vuepress">
    
    <link rel="preload" href="/assets/css/0.styles.d3d7476b.css" as="style"><link rel="preload" href="/assets/js/app.f97d11e0.js" as="script"><link rel="preload" href="/assets/js/2.c4a55d75.js" as="script"><link rel="preload" href="/assets/js/24.a36116e9.js" as="script"><link rel="prefetch" href="/assets/js/10.cd830b02.js"><link rel="prefetch" href="/assets/js/11.7c4cbfc9.js"><link rel="prefetch" href="/assets/js/12.2fc5ef62.js"><link rel="prefetch" href="/assets/js/13.35b2e41a.js"><link rel="prefetch" href="/assets/js/14.15d3b615.js"><link rel="prefetch" href="/assets/js/15.3b004cd7.js"><link rel="prefetch" href="/assets/js/16.ef0b6eaf.js"><link rel="prefetch" href="/assets/js/17.516ad126.js"><link rel="prefetch" href="/assets/js/18.a14128ad.js"><link rel="prefetch" href="/assets/js/19.48135194.js"><link rel="prefetch" href="/assets/js/20.f53e3b63.js"><link rel="prefetch" href="/assets/js/21.ec6e36d2.js"><link rel="prefetch" href="/assets/js/22.e7715ba2.js"><link rel="prefetch" href="/assets/js/23.e0693374.js"><link rel="prefetch" href="/assets/js/25.634dca41.js"><link rel="prefetch" href="/assets/js/26.b9622f5c.js"><link rel="prefetch" href="/assets/js/27.eb49a96a.js"><link rel="prefetch" href="/assets/js/28.84d60169.js"><link rel="prefetch" href="/assets/js/29.53bf131a.js"><link rel="prefetch" href="/assets/js/3.0ec01e5e.js"><link rel="prefetch" href="/assets/js/30.1331a972.js"><link rel="prefetch" href="/assets/js/31.ac0a72dd.js"><link rel="prefetch" href="/assets/js/4.2176f0d8.js"><link rel="prefetch" href="/assets/js/5.91c18d5d.js"><link rel="prefetch" href="/assets/js/6.537e369f.js"><link rel="prefetch" href="/assets/js/7.426639d5.js"><link rel="prefetch" href="/assets/js/8.32bf23b4.js"><link rel="prefetch" href="/assets/js/9.dc91dd0d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d3d7476b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">CHAO BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章分类" class="dropdown-title"><span class="title">文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="文章分类" class="mobile-dropdown-title"><span class="title">文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/articles/前端/css/" class="nav-link">
  css
</a></li><li class="dropdown-subitem"><a href="/articles/前端/js/" class="nav-link">
  js
</a></li><li class="dropdown-subitem"><a href="/articles/前端/Vue/" class="nav-link">
  vue
</a></li><li class="dropdown-subitem"><a href="/articles/前端/React/" class="nav-link">
  React
</a></li><li class="dropdown-subitem"><a href="/articles/前端/library/" class="nav-link">
  工具库
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/articles/设计/" class="nav-link">
  设计
</a></li><li class="dropdown-item"><!----> <a href="/articles/后端/" class="nav-link">
  后端
</a></li><li class="dropdown-item"><!----> <a href="/articles/编程通用/" class="nav-link">
  编程通用
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章分类" class="dropdown-title"><span class="title">文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="文章分类" class="mobile-dropdown-title"><span class="title">文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/articles/前端/css/" class="nav-link">
  css
</a></li><li class="dropdown-subitem"><a href="/articles/前端/js/" class="nav-link">
  js
</a></li><li class="dropdown-subitem"><a href="/articles/前端/Vue/" class="nav-link">
  vue
</a></li><li class="dropdown-subitem"><a href="/articles/前端/React/" class="nav-link">
  React
</a></li><li class="dropdown-subitem"><a href="/articles/前端/library/" class="nav-link">
  工具库
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/articles/设计/" class="nav-link">
  设计
</a></li><li class="dropdown-item"><!----> <a href="/articles/后端/" class="nav-link">
  后端
</a></li><li class="dropdown-item"><!----> <a href="/articles/编程通用/" class="nav-link">
  编程通用
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/articles/编程通用/函数式编程.html" class="active sidebar-link">函数式编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#一等公民" class="sidebar-link">一等公民</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#高阶函数" class="sidebar-link">高阶函数</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#闭包" class="sidebar-link">闭包</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#纯函数的定义" class="sidebar-link">纯函数的定义</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#loadsh" class="sidebar-link">loadsh</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#纯函数的好处" class="sidebar-link">纯函数的好处</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#副作用" class="sidebar-link">副作用</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#loadsh中的柯里化函数" class="sidebar-link">loadsh中的柯里化函数</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#意义" class="sidebar-link">意义</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#定义-2" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#loadsh中的组合函数" class="sidebar-link">loadsh中的组合函数</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#结合律" class="sidebar-link">结合律</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#调试" class="sidebar-link">调试</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#fp模块" class="sidebar-link">fp模块</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#maybe-函子" class="sidebar-link">MayBe 函子</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#editor函子" class="sidebar-link">Editor函子</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#io函子" class="sidebar-link">IO函子</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#task函子" class="sidebar-link">Task函子</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#pointed函子" class="sidebar-link">Pointed函子</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#monad函子" class="sidebar-link">Monad函子</a></li><li class="sidebar-sub-header"><a href="/articles/编程通用/函数式编程.html#folktalk" class="sidebar-link">Folktalk</a></li></ul></li><li><a href="/articles/编程通用/设计模式.html" class="sidebar-link">设计模式</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="相关概念"><a href="#相关概念" class="header-anchor">#</a> 相关概念</h1> <blockquote><p>函数式编程（FP）出现的概念很早，甚至比第一台计算机还要早.</p> <p>这里的函数指的是数学中的函数，即一种映射关系y=f(x)，相同的输入始终要得到相同的输出。</p></blockquote> <h2 id="一等公民"><a href="#一等公民" class="header-anchor">#</a> 一等公民</h2> <p>在js中函数是一等公民。</p> <ul><li>函数可以作为一个普通的变量存储</li> <li>可以作为函数的参数和返回值</li></ul> <h2 id="高阶函数"><a href="#高阶函数" class="header-anchor">#</a> 高阶函数</h2> <p>将函数作为参数或者返回值</p> <p>可以抽象通用的问题，帮我们屏蔽细节，只关注与我们有关的目标</p> <blockquote><p>函数作为参数</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fn</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token function">forEach</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>函数作为返回值</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> say <span class="token operator">=</span> <span class="token function">makeFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>once函数</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">once</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h2> <p>函数和其作用域内的变量捆绑在一起的现象称为闭包。</p> <p>在js中的具体体现就是在一个函数外，可以通过一个函数的内部函数访问其内部变量。</p> <p>例如上面的例子中模拟的 <code>once</code>函数和 <code>makeFn</code>函数就形成了闭包。</p> <h1 id="纯函数"><a href="#纯函数" class="header-anchor">#</a> 纯函数</h1> <h2 id="纯函数的定义"><a href="#纯函数的定义" class="header-anchor">#</a> 纯函数的定义</h2> <ul><li>相同的输入得到相同的输出，且没有任何的副作用。</li> <li>必须有输入和输出。</li> <li>函数式编程不会保留中间的结果，因此函数中的变量是无状态的。</li> <li>可以把一个函数的执行结果交给另一个函数去处理。</li></ul> <p>例如数组的方法slice和splice，前者是纯函数，后者不是</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 不改变原数组，返回一个新的数组</span>
arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 返回修改后的数组</span>
</code></pre></div><h2 id="loadsh"><a href="#loadsh" class="header-anchor">#</a> loadsh</h2> <blockquote><p>纯函数的代表，一个jsvascript的第三方库，提供了大量的纯函数</p></blockquote> <h2 id="纯函数的好处"><a href="#纯函数的好处" class="header-anchor">#</a> 纯函数的好处</h2> <ol><li>可缓存</li></ol> <p>因为纯函数对相同的输入始终得到相同的输出，就可以对函数的结果进行缓存。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 缓存函数</span>
<span class="token keyword">function</span> <span class="token function">memoize</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span>
  
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> key <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getArea</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> r <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> getAreaWithCache <span class="token operator">=</span> <span class="token function">memoize</span><span class="token punctuation">(</span>getArea<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>方便测试</li> <li>并行处理</li></ol> <p>纯函数不需要共享的内存数据，因此可以随意并行。</p> <h2 id="副作用"><a href="#副作用" class="header-anchor">#</a> 副作用</h2> <p>如果一个函数依赖外部的状态，就可能带来副作用，会导致函数变得不纯。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> mint <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">checkAge</span> <span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 这个函数依赖一个函数外的变量导致函数不纯</span>
  <span class="token keyword">return</span> age <span class="token operator">&gt;</span> mint<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">checkAge</span> <span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mint <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> age <span class="token operator">&gt;</span> mint<span class="token punctuation">;</span> <span class="token comment">// 虽然不依赖函数外的值，但是存在一个常量会导致硬编码</span>
<span class="token punctuation">}</span>
</code></pre></div><p>所有的外部交互都会带来副作用，我们不可能完全禁止，但要尽可能得控制。</p> <h1 id="柯里化"><a href="#柯里化" class="header-anchor">#</a> 柯里化</h1> <h2 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h2> <blockquote><p>当一个函数有多个参数的时候，可以先传递一部分参数（这部分参数以后不会变）。然后返回一个新的函数，并接收其余的参数。</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">checkAge</span> <span class="token operator">=</span> <span class="token parameter">min</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">age</span> <span class="token operator">=&gt;</span> age <span class="token operator">&gt;</span> min<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// es6的箭头函数使得函数柯里化的写法十分简洁</span>

<span class="token keyword">const</span> checkAge18 <span class="token operator">=</span> <span class="token function">checkAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> flag <span class="token operator">=</span> <span class="token function">checkAge18</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="loadsh中的柯里化函数"><a href="#loadsh中的柯里化函数" class="header-anchor">#</a> loadsh中的柯里化函数</h2> <p><code>curry</code> 将一个函数转换为柯里化函数，将多元函数转化为一元函数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

sum <span class="token operator">=</span> <span class="token function">carry</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 这三种调用的方法得到的结果都是一样的</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// carry函数的原理</span>
<span class="token keyword">function</span> <span class="token function">carry</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">carryFn</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果柯里化后的函数接受的参数和原始函数的参数数量不同，则返回一个新的函数</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> func<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 将已接受的函数，和新接受的函数合并在一起</span>
        <span class="token keyword">return</span> <span class="token function">carryFn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span> 
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="意义"><a href="#意义" class="header-anchor">#</a> 意义</h2> <p>函数柯里化使得我们可以传递较少的参数得到一个记住固定参数的新函数，他是对函数参数的一种缓存。</p> <p>可以让函数变得更小更灵活，将多元函数转化为一元函数，使用函数组合产生强大的功能。</p> <h1 id="函数组合"><a href="#函数组合" class="header-anchor">#</a> 函数组合</h1> <h2 id="定义-2"><a href="#定义-2" class="header-anchor">#</a> 定义</h2> <p>函数组合式函数柯里化的逆过程，将细小的函数组合为一个较大的函数。</p> <p>一个函数要经过多个函数的处理才能得到最终结果，这个时候可以将多个函数组合起来。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> fn <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">,</span> f3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>组合函数默认会从右到左执行。</p> <h2 id="loadsh中的组合函数"><a href="#loadsh中的组合函数" class="header-anchor">#</a> loadsh中的组合函数</h2> <p>loadsh中的组合函数有两个，分别是 <code>flow</code>和 <code>flowRight</code>。</p> <p><code>flow</code>是<strong>从左到右</strong>运行，<code>flowRight</code>是<strong>从右到左</strong>运行。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">reverse</span> <span class="token operator">=</span> <span class="token parameter">arr</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">first</span> <span class="token operator">=</span> <span class="token parameter">arr</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">toUpper</span> <span class="token operator">=</span> <span class="token parameter">s</span> <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token function">_flowRight</span><span class="token punctuation">(</span>toUpper<span class="token punctuation">,</span> first<span class="token punctuation">,</span> reverse<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// flow函数模拟</span>
<span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// reduce 函数可以利用数组中的每一项对一个变量进行操作</span>
    <span class="token keyword">return</span> args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>acc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="结合律"><a href="#结合律" class="header-anchor">#</a> 结合律</h2> <blockquote><p>函数的组合要满足结合律</p> <p>例如上面的案例，取出数组中的最后一个元素将其首字母大写。</p> <p>我们可以先反转数组，再取出最后一个元素使其首字母大写。也可以先反转数组后取出最后一个元素，再让其首字母大写。</p></blockquote> <h2 id="调试"><a href="#调试" class="header-anchor">#</a> 调试</h2> <p>使用trace函数对组合函数进行调试</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> trace <span class="token operator">=</span> <span class="token function">_carry</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> v<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="loadsh-2"><a href="#loadsh-2" class="header-anchor">#</a> loadsh</h1> <h2 id="fp模块"><a href="#fp模块" class="header-anchor">#</a> fp模块</h2> <p>loadsh的fp模块提供了大量的函数式编程友好的函数，这些函数已经被柯里化，并且满足<strong>函数优先，数据滞后</strong>的原则；</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loadsh/fp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="point-free"><a href="#point-free" class="header-anchor">#</a> Point Free</h1> <ul><li>不需要指明具体的数据w</li> <li>只需要定义对数据的运算过程</li> <li>需要预先定义好大量的数据运算过程</li></ul> <h1 id="functor-函子"><a href="#functor-函子" class="header-anchor">#</a> Functor 函子</h1> <blockquote><p>函子可以在使用函数式编程时尽可能得控制副作用，处理异常，进行异步操作。</p> <p>函子是一个特殊的容器，可以通过map方法来使用特定的函数对值进行处理。</p> <p>这个值永远不会被取出，当你想使用的时候需要使用map函数来处理。</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Functor</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token comment">// 下划线开头的值为私有值，不允许外部访问。</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">static</span> <span class="token keyword">of</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Functor</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Functor</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="maybe-函子"><a href="#maybe-函子" class="header-anchor">#</a> MayBe 函子</h2> <blockquote><p>maybe函子可以对空值异常进行处理</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MayBe</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">static</span> <span class="token keyword">of</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MayBe</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">isNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> MayBe<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">:</span> MayBe<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">isNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="editor函子"><a href="#editor函子" class="header-anchor">#</a> Editor函子</h2> <blockquote><p>Editor 函子类似于if else的处理，可以进行try catch的错误处理</p></blockquote> <h2 id="io函子"><a href="#io函子" class="header-anchor">#</a> IO函子</h2> <blockquote><p>IO函子中的 <code>_value</code>是一个函数，把不存的操作存入 <code>_value</code>中，交给调用者来处理，来延迟这个不纯的操作。</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loadsh/fp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">IO</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> fn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">static</span> <span class="token keyword">of</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">IO</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">IO</span><span class="token punctuation">(</span>fp<span class="token punctuation">.</span><span class="token function">flowRight</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="task函子"><a href="#task函子" class="header-anchor">#</a> Task函子</h2> <blockquote><p>task函子用来处理异步。</p></blockquote> <h2 id="pointed函子"><a href="#pointed函子" class="header-anchor">#</a> Pointed函子</h2> <blockquote><p>pointed函子是实现了of方法的函子， 避免使用new 来创建函子。</p></blockquote> <h2 id="monad函子"><a href="#monad函子" class="header-anchor">#</a> Monad函子</h2> <blockquote><p>同时实现了of方法和join方法的函子称为monad函子，可以将函子扁平化，解除函子的嵌套。</p></blockquote> <h2 id="folktalk"><a href="#folktalk" class="header-anchor">#</a> Folktalk</h2> <p>floktalk 也是一个函数式编程的库。</p> <p>它不提供功能性的函数，只提供函数式编程相关的处理函数。例如carry, compose函数，MayBe函子，Editor函子等。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/articles/编程通用/设计模式.html">
        设计模式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f97d11e0.js" defer></script><script src="/assets/js/2.c4a55d75.js" defer></script><script src="/assets/js/24.a36116e9.js" defer></script>
  </body>
</html>
